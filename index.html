<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Z市场分析器</title>
    <link rel="stylesheet" href="style.css?v=2.1">
    <!-- 使用 CDN 引入库 -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- 顶部导航 -->
    <header class="header">
        <div class="container">
            <h1>⛏️ Minecraft 交易市场</h1>
            <p class="subtitle">智能搜索 · 价格分析 · 数据可视化</p>
        </div>
    </header>

    <!-- 主容器 -->
    <div class="container">
        
        <!-- 过滤提示 -->
        <div id="filterNotice" style="display: none;" class="filter-notice">
            🔒 已自动过滤 <span id="filteredCount">0</span> 个保险柜价格（≥ $10,000,000）
        </div>
        
        <!-- 统计卡片区域 -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">📊</div>
                <div class="stat-info">
                    <div class="stat-label">总交易数</div>
                    <div class="stat-value" id="totalTrades">-</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">👥</div>
                <div class="stat-info">
                    <div class="stat-label">活跃卖家</div>
                    <div class="stat-value" id="totalPlayers">-</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">🎁</div>
                <div class="stat-info">
                    <div class="stat-label">物品种类</div>
                    <div class="stat-value" id="totalItems">-</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">💰</div>
                <div class="stat-info">
                    <div class="stat-label">平均价格</div>
                    <div class="stat-value" id="avgPrice">-</div>
                </div>
            </div>
        </div>

        <!-- 标签页导航 -->
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('market')">🛒 市场交易</button>
            <button class="tab-btn" onclick="switchTab('analysis')">📈 数据分析</button>
            <button class="tab-btn" onclick="switchTab('comparison')">🔍 价格对比</button>
        </div>

        <!-- 市场交易标签页 -->
        <div id="market-tab" class="tab-content active">
            <div class="filter-section">
                <h3>🔍 高级筛选</h3>
                <div class="filter-grid">
                    <div class="filter-item">
                        <label>价格区间：</label>
                        <div class="price-range">
                            <input type="number" id="minPrice" placeholder="最低价">
                            <span>-</span>
                            <input type="number" id="maxPrice" placeholder="最高价">
                        </div>
                    </div>
                    <div class="filter-item">
                        <label>数量范围：</label>
                        <div class="price-range">
                            <input type="number" id="minQty" placeholder="最少数量">
                            <span>-</span>
                            <input type="number" id="maxQty" placeholder="最多数量">
                        </div>
                    </div>
                    <div class="filter-item">
                        <button class="btn btn-primary" onclick="applyFilters()">应用筛选</button>
                        <button class="btn btn-secondary" onclick="resetFilters()">重置</button>
                    </div>
                </div>
            </div>

            <div class="table-container">
                <table id="marketTable" class="display" style="width:100%">
                    <thead>
                        <tr>
                            <th>玩家</th>
                            <th>物品</th>
                            <th>数量</th>
                            <th>单价</th>
                            <th title="单价 × 数量 = 购买该商品所需总花费">总价 <span class="tooltip-icon">ⓘ</span></th>
                            <th>位置</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 数据分析标签页 -->
        <div id="analysis-tab" class="tab-content">
            <div class="analysis-grid">
                <div class="chart-container">
                    <h3>📊 热门物品 TOP 10</h3>
                    <canvas id="topItemsChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>👑 活跃卖家 TOP 10</h3>
                    <canvas id="topPlayersChart"></canvas>
                </div>
            </div>
            
            <div class="analysis-grid">
                <div class="chart-container">
                    <h3>💎 最贵物品 TOP 10</h3>
                    <canvas id="expensiveItemsChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>💵 价格分布</h3>
                    <canvas id="priceDistChart"></canvas>
                </div>
            </div>

            <div class="ranking-section">
                <div class="ranking-card">
                    <h3>🏆 大卖家排行榜</h3>
                    <div id="sellerRanking" class="ranking-list"></div>
                </div>
                <div class="ranking-card">
                    <h3>💰 高价物品排行榜</h3>
                    <div id="expensiveRanking" class="ranking-list"></div>
                </div>
            </div>
        </div>

        <!-- 价格对比标签页 -->
        <div id="comparison-tab" class="tab-content">
            <div class="comparison-section">
                <h3>🔍 物品价格对比</h3>
                <p class="hint">在下方搜索框输入物品名称，查看不同卖家的价格对比</p>
                <div class="search-box">
                    <input type="text" id="itemSearch" placeholder="输入物品名称搜索..." oninput="searchItemForComparison()">
                </div>
                <div id="comparisonResults"></div>
            </div>
        </div>

    </div>

    <!-- 页脚 -->
    <footer class="footer">
        <p>zzzzzyc@hotmail.com zzzzzyc@2025版权所有 | 数据更新时间: <span id="updateTime">-</span></p>
    </footer>

    <script src="app.js?v=2.1"></script>
</body>
</html>

